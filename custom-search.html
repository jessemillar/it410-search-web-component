<!-- Defines element markup -->
<template>
	<form>
		<input type="text"/><button>Poots</button>
	</form>
</template>

<script>
	(function(window, document, undefined) {
		// Refers to the "importer", which is index.html
		var parentDoc = document;

		// Refers to the "importee", which is src/custom-search.html
		var thisDoc = (parentDoc._currentScript || parentDoc.currentScript).ownerDocument;

		// Gets content from <template>
		var template = thisDoc.querySelector('template').content;

		// Creates an object based in the HTML Element prototype
		var elementPrototype = Object.create(HTMLElement.prototype);

		// Creates the "searchValue" attribute and sets a default value
		elementPrototype.searchValue = 'Search...';

		// Fires when an instance of the element is created
		elementPrototype.createdCallback = function() {
			// Creates the shadow root
			var shadowRoot = this.createShadowRoot();

			// Adds a template clone into shadow root
			var clone = parentDoc.importNode(template, true);
			shadowRoot.appendChild(clone);

			// Caches <strong> DOM query
			this.input = shadowRoot.querySelector('input');

			// Checks if the "searchValue" attribute has been overwritten
			if (this.hasAttribute('searchValue')) {
				var searchValue = this.getAttribute('searchValue');
				this.set(searchValue);
			} else {
				this.set(this.searchValue);
			}
		};

		// Fires when an attribute was added, removed, or updated
		elementPrototype.attributeChangedCallback = function(attr, oldVal, newVal) {
			if (attr === 'searchValue') {
				this.set(newVal);
			}
		};

		// Sets new value of the search field
		elementPrototype.set = function(val) {
			this.input.value = val;
		};

		// Gets the value of the search field
		elementPrototype.get = function() {
			return this.input.value;
		};

		// Registers <custom-search> in the main document
		window.MyElement = parentDoc.registerElement('custom-search', {
			prototype: elementPrototype
		});
	})(window, document);
</script>
